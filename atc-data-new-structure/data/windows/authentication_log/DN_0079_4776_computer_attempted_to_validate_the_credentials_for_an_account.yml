title: The computer attempted to validate the credentials for an account
description: >
  This event generates every time that a credential validation occurs 
  using NTLM authentication. This event occurs only on the computer 
  that is authoritative for the provided credentials. For domain 
  accounts, the domain controller is authoritative. For local accounts, 
  the local computer is authoritative
event_id: 4776
attack_data:
  - logon session: logon session creation
platform: windows
provider: Microsoft-Windows-Security-Auditing
channel: Security
atc_id: DN0079
loggingpolicy:
  - LP0107: [ "Success", "Failure" ]
contributors:
  - '@atc_project'
references:
  - text: 'Microsoft Docs: event-4776.md'
    link: 'https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4776.md'
  - text: 'OSSEM DD: event-4776.yml'
    link: 'https://github.com/OTRF/OSSEM/blob/master/source/data_dictionaries/windows/etw-providers/Microsoft-Windows-Security-Auditing/events/event-4776.yml'
fields:

  - original_name: PackageName
    description: >
      The name of Authentication Package which was used for credential validation.
      It is always "MICROSOFT_AUTHENTICATION_PACKAGE_V1_0" for 4776 event.
    sample_value: MICROSOFT_AUTHENTICATION_PACKAGE_V1_0
    elastic_ecs_name: winlog.event_data.PackageName
    splunk_cim_name: N/A
    otr_ossem_name: logon_authentication_package_name
    
  - original_name: TargetUserName
    description: >
      the name of the account that had its credentials validated by the Authentication
      Package. Can be user name, computer account name or well-known security principal
      account name.
    sample_value: dadmin
    elastic_ecs_name: related.user
    splunk_cim_name: N/A
    otr_ossem_name: user_name
    
  - original_name: Workstation
    description: The name of the computer from which the logon attempt originated.
    sample_value: WIN81
    elastic_ecs_name: winlog.event_data.Workstation
    splunk_cim_name: N/A
    otr_ossem_name: src_host_name
    
  - original_name: Status
    description: >
      Contains error code for Failure events. For Success events this parameter
      has "0x0" value.
    sample_value: '0xc0000234'
    elastic_ecs_name: winlog.logon.failure.status
    splunk_cim_name: N/A
    otr_ossem_name: event_status

sample: |
  - <Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
    - <System>
      <Provider Name="Microsoft-Windows-Security-Auditing" Guid="{54849625-5478-4994-A5BA-3E3B0328C30D}" /> 
      <EventID>4776</EventID> 
      <Version>0</Version> 
      <Level>0</Level> 
      <Task>14336</Task> 
      <Opcode>0</Opcode> 
      <Keywords>0x8010000000000000</Keywords> 
      <TimeCreated SystemTime="2015-07-25T04:38:11.003163100Z" /> 
      <EventRecordID>165437</EventRecordID> 
      <Correlation /> 
      <Execution ProcessID="500" ThreadID="532" /> 
      <Channel>Security</Channel> 
      <Computer>DC01.contoso.local</Computer> 
      <Security /> 
    </System>
    - <EventData>
      <Data Name="PackageName">MICROSOFT\_AUTHENTICATION\_PACKAGE\_V1\_0</Data> 
      <Data Name="TargetUserName">dadmin</Data> 
      <Data Name="Workstation">WIN81</Data> 
      <Data Name="Status">0xc0000234</Data> 
    </EventData>
  </Event>
