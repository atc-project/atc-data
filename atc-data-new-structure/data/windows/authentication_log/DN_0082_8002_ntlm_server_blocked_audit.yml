title: NTLM server blocked audit
description: >
  Audit Incoming NTLM Traffic that would be blocked. Actually it's just event 
  about NTLM authentication, it doesn't necessary supposed to be blocked. 
  Blocked NTLM auth is the same provider but Event ID 4002
event_id: 8002
attack_data:
  - logon session: logon session creation
platform: windows
provider: Microsoft-Windows-NTLM
channel: Microsoft-Windows-NTLM/Operational
atc_id: DN0082
loggingpolicy:
  - LP0044
contributors:
  - '@atc_project'
references:
  - text: 'Microsoft Docs: Restrict NTLM: Audit NTLM authentication in this domain'
    link: 'https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/network-security-restrict-ntlm-audit-ntlm-authentication-in-this-domain'
fields:

  - original_name: CallerPID
    description: None
    sample_value: '4'
    elastic_ecs_name: winlog.event_data.CallerPID
    splunk_cim_name: N/A
    otr_ossem_name: N/A

  - original_name: ProcessName
    description: None
    sample_value: ''
    elastic_ecs_name: winlog.event_data.ProcessName
    splunk_cim_name: N/A
    otr_ossem_name: N/A

  - original_name: ClientLUID
    description: None
    sample_value: '0x3e7'
    elastic_ecs_name: winlog.event_data.ClientLUID
    splunk_cim_name: N/A
    otr_ossem_name: N/A

  - original_name: ClientUserName
    description: None
    sample_value: 'DC$'
    elastic_ecs_name: winlog.event_data.ClientUserName
    splunk_cim_name: N/A
    otr_ossem_name: N/A

  - original_name: ClientDomainName
    description: None
    sample_value: atc
    elastic_ecs_name: winlog.event_data.ClientDomainName
    splunk_cim_name: N/A
    otr_ossem_name: N/A

  - original_name: MechanismOID
    description: None
    sample_value: '1.3.6.1.4.1.311.2.2.10'
    elastic_ecs_name: winlog.event_data.MechanismOID
    splunk_cim_name: N/A
    otr_ossem_name: N/A

sample: |
  - <Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
    - <System>
        <Provider Name="Microsoft-Windows-NTLM" Guid="{AC43300D-5FCC-4800-8E99-1BD3F85F0320}" /> 
        <EventID>8002</EventID> 
        <Version>0</Version> 
        <Level>4</Level> 
        <Task>2</Task> 
        <Opcode>0</Opcode> 
        <Keywords>0x8000000000000000</Keywords> 
        <TimeCreated SystemTime="2019-03-02T23:00:00.746139000Z" /> 
        <EventRecordID>12</EventRecordID> 
        <Correlation /> 
        <Execution ProcessID="468" ThreadID="2660" /> 
        <Channel>Microsoft-Windows-NTLM/Operational</Channel> 
        <Computer>dc.yugoslavskiy.local</Computer> 
        <Security UserID="S-1-5-18" /> 
      </System>
    - <EventData>
        <Data Name="CallerPID">4</Data> 
        <Data Name="ProcessName" /> 
        <Data Name="ClientLUID">0x3e7</Data> 
        <Data Name="ClientUserName">DC$</Data> 
        <Data Name="ClientDomainName">atc</Data> 
      <Data Name="MechanismOID">1.3.6.1.4.1.311.2.2.10</Data> 
      </EventData>
    </Event>