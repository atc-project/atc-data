title: A handle to an object was requested
description: >
  This event indicates that specific access was requested for an object. 
  The object could be a file system, kernel, or registry object, or a file 
  system object on removable storage or a device. If access was declined, 
  a Failure event is generated. This event generates only if the objectâ€™s 
  SACL has the required ACE to handle the use of specific access rights
event_id: 4656
attack_data:
  - file: file access
  - windows registry: windows registry key access
  - process: process access
platform: windows
provider: Microsoft-Windows-Security-Auditing
channel: Security
atc_id: DN0058
loggingpolicy:
  - LP0104: [ "Success", "Failure" ] # windows_audit_removable_storage
  - LP0039: [ "Success", "Failure" ] # windows_audit_kernel_object
  - LP0102: [ "Success", "Failure" ] # windows_audit_file_system
  - LP0103: [ "Success", "Failure" ] # windows_audit_registry
contributors:
  - '@atc_project'
references:
  - text: 'Microsoft Docs: event-4656.md'
    link: 'https://github.com/MicrosoftDocs/windows-itpro-docs/blob/master/windows/security/threat-protection/auditing/event-4656.md'
  - text: 'OSSEM DD: event-4656.yml'
    link: 'https://github.com/OTRF/OSSEM/blob/master/source/data_dictionaries/windows/etw-providers/Microsoft-Windows-Security-Auditing/events/event-4656.yml'
fields:

  - original_name: SubjectUserSid
    description: SID of account that requested a handle to an object.
    sample_value: S-1-5-21-3457937927-2839227994-823803824-1104
    elastic_ecs_name: user.id
    splunk_cim_name: user_id
    otr_ossem_name: user_sid
    
  - original_name: SubjectUserName
    description: the name of the account that requested a handle to an object.
    sample_value: dadmin
    elastic_ecs_name: user.name
    splunk_cim_name: user
    otr_ossem_name: user_name
    
  - original_name: SubjectDomainName
    description: Subject's domain or computer name.
    sample_value: CONTOSO
    elastic_ecs_name: user.domain
    splunk_cim_name: src_nt_domain
    otr_ossem_name: user_domain
    
  - original_name: SubjectLogonId
    description: >
      hexadecimal value that can help you correlate this event with recent
      events that might contain the same Logon ID
    sample_value: '0x4367b'
    elastic_ecs_name: winlog.logon.id
    splunk_cim_name: N/A
    otr_ossem_name: user_logon_id
    
  - original_name: ObjectServer
    description: has "Security" value for this event.
    sample_value: Security
    elastic_ecs_name: winlog.event_data.ObjectServer
    splunk_cim_name: N/A
    otr_ossem_name: object_server
    
  - original_name: ObjectType
    description: The type of an object that was accessed during the operation.
    sample_value: File
    elastic_ecs_name: winlog.event_data.ObjectType
    splunk_cim_name: N/A
    otr_ossem_name: object_type
    
  - original_name: ObjectName
    description: >
      name and other identifying information for the object for which access
      was requested. For example, for a file, the path would be included.
    sample_value: C:\Documents\HBI Data.txt
    elastic_ecs_name: winlog.event_data.ObjectName
    splunk_cim_name: N/A
    otr_ossem_name: object_name
    
  - original_name: HandleId
    description: >
      'hexadecimal value of a handle to Object Name. This field can help
      you correlate this event with other events that might contain the same Handle
      ID, for example, "4663(S): An attempt was made to access an object."'
    sample_value: '0x0'
    elastic_ecs_name: winlog.event_data.HandleId
    splunk_cim_name: N/A
    otr_ossem_name: object_handle_id
    
  - original_name: TransactionId
    description: >
      'unique GUID of the transaction. This field can help you correlate
      this event with other events that might contain the same Transaction ID, such
      as "4660(S): An object was deleted."'
    sample_value: '{00000000-0000-0000-0000-000000000000}'
    elastic_ecs_name: winlog.event_data.TransactionId
    splunk_cim_name: N/A
    otr_ossem_name: transaction_guid
    
  - original_name: AccessList
    description: >
      the list of access rights which were requested by Subject\Security ID.
    sample_value: '%%1538 %%1541 %%4416 %%4417 %%4418 %%4419 %%4420 %%4423 %%4424'
    elastic_ecs_name: winlog.event_data.AccessList
    splunk_cim_name: N/A
    otr_ossem_name: user_access_list
    
  - original_name: AccessReason
    description: >
      the list of access check results. The format of this varies, depending
      on the object. For kernel objects, this field does not apply.
    sample_value: >
      '%%1538: %%1804 %%1541: %%1809 %%4416: %%1809 %%4417: %%1809 %%4418:
      %%1802 D:(D;;LC;;;S-1-5-21-3457937927-2839227994-823803824-1104) %%4419: %%1809
      %%4420: %%1809 %%4423: %%1811 D:(A;OICI;FA;;;S-1-5-21-3457937927-2839227994-823803824-1104)
      %%4424: %%1809'
    elastic_ecs_name: winlog.event_data.AccessReason
    splunk_cim_name: N/A
    otr_ossem_name: object_access_reason
    
  - original_name: AccessMask
    description: >
      hexadecimal mask for the requested or performed operation. For more
      information, see the preceding table.
    sample_value: '0x12019f'
    elastic_ecs_name: winlog.event_data.AccessMask
    splunk_cim_name: N/A
    otr_ossem_name: object_access_mask
    
  - original_name: PrivilegeList
    description: >
      the list of user privileges which were used during the operation, for
      example, SeBackupPrivilege.
    sample_value: '-'
    elastic_ecs_name: winlog.event_data.PrivilegeList
    splunk_cim_name: N/A
    otr_ossem_name: user_privilege_list
    
  - original_name: RestrictedSidCount
    description: >
      Number of restricted SIDs in the token. Applicable to only specific
      Object Types.
    sample_value: '-'
    elastic_ecs_name: winlog.event_data.RestrictedSidCount
    splunk_cim_name: N/A
    otr_ossem_name: token_restricted_sid_count
    
  - original_name: ProcessId
    description: >
      hexadecimal Process ID of the process through which the access was
      requested.
    sample_value: '0x1074'
    elastic_ecs_name: process.pid
    splunk_cim_name: process_id
    otr_ossem_name: process_id
    
  - original_name: ProcessName
    description: full path and the name of the executable for the process.
    sample_value: C:\Windows\System32\notepad.exe
    elastic_ecs_name: process.executable
    splunk_cim_name: process_path
    otr_ossem_name: process_path
    
  - original_name: ResourceAttributes
    description: >
      attributes associated with the object. For some objects, the field
      does not apply and "-" is displayed
    sample_value: S:AI(RA;ID;;;;WD;("Impact_MS",TI,0x10020,3000))
    elastic_ecs_name: winlog.event_data.ResourceAttributes
    splunk_cim_name: N/A
    otr_ossem_name: object_resource_attributes

sample: |
  - <Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event">
    - <System>
      <Provider Name="Microsoft-Windows-Security-Auditing" Guid="{54849625-5478-4994-A5BA-3E3B0328C30D}" /> 
      <EventID>4656</EventID> 
      <Version>1</Version> 
      <Level>0</Level> 
      <Task>12800</Task> 
      <Opcode>0</Opcode> 
      <Keywords>0x8010000000000000</Keywords> 
      <TimeCreated SystemTime="2015-09-18T22:15:19.346776600Z" /> 
      <EventRecordID>274057</EventRecordID> 
      <Correlation /> 
      <Execution ProcessID="516" ThreadID="524" /> 
      <Channel>Security</Channel> 
      <Computer>DC01.contoso.local</Computer> 
      <Security /> 
    </System>
    - <EventData>
      <Data Name="SubjectUserSid">S-1-5-21-3457937927-2839227994-823803824-1104</Data> 
      <Data Name="SubjectUserName">dadmin</Data> 
      <Data Name="SubjectDomainName">CONTOSO</Data> 
      <Data Name="SubjectLogonId">0x4367b</Data> 
      <Data Name="ObjectServer">Security</Data> 
      <Data Name="ObjectType">File</Data> 
      <Data Name="ObjectName">C:\\Documents\\HBI Data.txt</Data> 
      <Data Name="HandleId">0x0</Data> 
      <Data Name="TransactionId">{00000000-0000-0000-0000-000000000000}</Data> 
      <Data Name="AccessList">%%1538 %%1541 %%4416 %%4417 %%4418 %%4419 %%4420 %%4423 %%4424</Data> 
      <Data Name="AccessReason">%%1538: %%1804 %%1541: %%1809 %%4416: %%1809 %%4417: %%1809 %%4418: %%1802 D:(D;;LC;;;S-1-5-21-3457937927-2839227994-823803824-1104) %%4419: %%1809 %%4420: %%1809 %%4423: %%1811 D:(A;OICI;FA;;;S-1-5-21-3457937927-2839227994-823803824-1104) %%4424: %%1809</Data> 
      <Data Name="AccessMask">0x12019f</Data> 
      <Data Name="PrivilegeList">-</Data> 
      <Data Name="RestrictedSidCount">0</Data> 
      <Data Name="ProcessId">0x1074</Data> 
      <Data Name="ProcessName">C:\\Windows\\System32\\notepad.exe</Data> 
      <Data Name="ResourceAttributes">S:AI(RA;ID;;;;WD;("Impact\_MS",TI,0x10020,3000))</Data> 
    </EventData>
  </Event>
